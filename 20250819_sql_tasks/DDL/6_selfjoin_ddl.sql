CREATE TABLE campaign_monthly (
  client_id    INT           NOT NULL,
  campaign_id  INT           NOT NULL,
  month_start  DATE          NOT NULL,  -- первый день месяца (нормализатор)
  impressions  INT           NOT NULL,
  clicks       INT           NOT NULL,
  spend        NUMERIC(12,2) NOT NULL,
  conversions  INT           NOT NULL,
  revenue      NUMERIC(12,2) NOT NULL,
  PRIMARY KEY (client_id, campaign_id, month_start)
);

INSERT INTO campaign_monthly
(client_id, campaign_id, month_start, impressions, clicks, spend, conversions, revenue)
VALUES
-- ======================
-- Клиент 101
-- ======================
-- Кампания 1: стабильный рост по всем метрикам
(101, 1, '2025-05-01', 120000, 3600, 4800.00, 120, 7200.00),
(101, 1, '2025-06-01', 150000, 4200, 5250.00, 135, 8100.00),
(101, 1, '2025-07-01', 180000, 5000, 6000.00, 160, 9600.00),

-- Кампания 2: работала только в мае, потом отключили
(101, 2, '2025-05-01',  80000, 1600, 2000.00,  48, 2880.00),

-- Кампания 3: стартовала только в июле
(101, 3, '2025-07-01',  90000, 2200, 2500.00,  70, 3500.00),


-- ======================
-- Клиент 202
-- ======================
-- Кампания 7: падение показателей от месяца к месяцу
(202, 7, '2025-05-01',  50000, 1000, 1500.00,  25, 2000.00),
(202, 7, '2025-06-01',  45000,  900, 1350.00,  20, 1800.00),
(202, 7, '2025-07-01',  30000,  600,  900.00,  15, 1200.00),

-- Кампания 8: новая кампания, появилась в июне и продолжилась в июле
(202, 8, '2025-06-01',  90000, 1800, 2700.00,  54, 4050.00),
(202, 8, '2025-07-01', 110000, 2100, 3100.00,  65, 4875.00),

-- Кампания 9: только в мае (разовая акция)
(202, 9, '2025-05-01',  20000,  400,  600.00,  12,  900.00),


-- ======================
-- Клиент 303
-- ======================
-- Кампания 15: пример с перерывом (май и июль, июнь пропущен)
(303, 15, '2025-05-01', 40000,  900, 1200.00,  30, 1500.00),
(303, 15, '2025-07-01', 60000, 1300, 1800.00,  45, 2400.00),

-- Кампания 16: активна все три месяца, плавный рост
(303, 16, '2025-05-01', 70000, 1500, 2100.00,  40, 2800.00),
(303, 16, '2025-06-01', 75000, 1600, 2200.00,  45, 3000.00),
(303, 16, '2025-07-01', 80000, 1700, 2300.00,  50, 3200.00),

-- Кампания 17: стартовала в мае, пик в июне, в июле сильно просела
(303, 17, '2025-05-01', 30000,  700,  900.00,  20, 1200.00),
(303, 17, '2025-06-01', 50000, 1200, 1500.00,  35, 2100.00),
(303, 17, '2025-07-01', 20000,  400,  600.00,  10,  600.00);
