CREATE TABLE user_logins (
  user_id    INT         NOT NULL,
  login_ts TIMESTAMP        NOT NULL
);

-- Пользователь 101
-- Серия на 5 дней подряд, разрыв, потом серия на 4 дня.
INSERT INTO user_logins (user_id, login_ts) VALUES
(101, '2025-01-01 09:15:00'),
(101, '2025-01-02 11:20:00'),
(101, '2025-01-03 08:45:00'),
(101, '2025-01-03 21:05:00'), -- второй логин в тот же день
(101, '2025-01-04 18:30:00'),
(101, '2025-01-05 10:00:00'),
-- разрыв (нет 2025-01-06)
(101, '2025-01-07 07:50:00'),
(101, '2025-01-08 12:15:00'),
(101, '2025-01-09 08:10:00'),
(101, '2025-01-09 22:30:00'),
(101, '2025-01-10 20:05:00');

-- Пользователь 102
-- Несколько коротких серий, в т.ч. переход через границу месяца
INSERT INTO user_logins (user_id, login_ts) VALUES
(102, '2025-01-11 14:00:00'),  -- серия 1 день
(102, '2025-01-15 09:10:00'),
(102, '2025-01-16 21:40:00'),  -- серия 2 дня
(102, '2025-01-20 08:05:00'),
(102, '2025-01-21 19:20:00'),
(102, '2025-01-22 22:45:00'),  -- серия 3 дня
(102, '2025-01-31 13:30:00'),
(102, '2025-02-01 09:00:00'),
(102, '2025-02-02 23:55:00');  -- серия 3 дня через границу месяца

-- Пользователь 103
-- Длинная серия 10 дней подряд
INSERT INTO user_logins (user_id, login_ts) VALUES
(103, '2025-03-01 10:00:00'),
(103, '2025-03-02 11:15:00'),
(103, '2025-03-03 12:20:00'),
(103, '2025-03-04 13:25:00'),
(103, '2025-03-05 14:30:00'),
(103, '2025-03-06 15:35:00'),
(103, '2025-03-07 16:40:00'),
(103, '2025-03-08 17:45:00'),
(103, '2025-03-09 18:50:00'),
(103, '2025-03-10 19:55:00');

-- Пользователь 104
-- Несортированные данные, одиночки и серия 3 дня
INSERT INTO user_logins (user_id, login_ts) VALUES
(104, '2025-04-05 20:00:00'),
(104, '2025-04-01 09:10:00'),
(104, '2025-04-02 21:15:00'),
(104, '2025-04-03 18:40:00'), -- серия 3 дня
(104, '2025-04-10 08:20:00'),
(104, '2025-04-12 22:10:00'),
(104, '2025-04-20 07:30:00'),
(104, '2025-04-22 13:15:00');
